Sample Name:Sample Name:1bc44eef75779e3ca1eefb8ff5a64807dbc942b1e4a2672d77b9f6928d292591
File ReName: hmw
File Type: PE32 Executable
md5: 3f4a16b29f2f0532b7ce3e7656799125
sha1: 61b25d11392172e587d8da3045812a66c3385451
sha256: 0385eeab00e946a302b24a91dea4187c1210597b8e17cd9e2230450f5ece21da

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry [T1112]                                                            |
| DISCOVERY              | File and Directory Discovery [T1083]                                               |
|                        | Query Registry [T1012]                                                             |
|                        | System Information Discovery [T1082]                                               |
|                        | System Service Discovery [T1007]                                                   |
| EXECUTION              | Command and Scripting Interpreter [T1059]                                          |
|                        | Shared Modules [T1129]                                                             |
|                        | System Services::Service Execution [T1569.002]                                     |
| IMPACT                 | Service Stop [T1489]                                                               |
| PERSISTENCE            | Create or Modify System Process::Windows Service [T1543.003]                       |
| PRIVILEGE ESCALATION   | Access Token Manipulation [T1134]                                                  |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| FILE SYSTEM                 | Delete File [C0047]                                                           |
|                             | Get File Attributes [C0049]                                                   |
|                             | Read File [C0051]                                                             |
|                             | Writes File [C0052]                                                           |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread [C0038]                                                         |
|                             | Terminate Process [C0018]                                                     |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| interact with driver via control codes (9 matches)   | host-interaction/driver                              |
| get common file path                                 | host-interaction/file-system                         |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists (2 matches)                     | host-interaction/file-system/exists                  |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| read file (3 matches)                                | host-interaction/file-system/read                    |
| write file (2 matches)                               | host-interaction/file-system/write                   |
| get disk information                                 | host-interaction/hardware/storage                    |
| get disk size (2 matches)                            | host-interaction/hardware/storage                    |
| check OS version                                     | host-interaction/os/version                          |
| modify access privileges (2 matches)                 | host-interaction/process/modify                      |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| delete registry key                                  | host-interaction/registry/delete                     |
| query service status                                 | host-interaction/service                             |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| modify service (2 matches)                           | host-interaction/service/modify                      |
| start service                                        | host-interaction/service/start                       |
| stop service                                         | host-interaction/service/stop                        |
| create thread (4 matches)                            | host-interaction/thread/create                       |
| link function at runtime                             | linking/runtime-linking                              |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+

Libraries:
    shlwapi.dll
    lz32.dll
    msvcrt.dll
    kernel32.dll
    user32.dll
    advapi32.dll
    shell32.dll

Suspicious Imports:
    ControlService
    DeleteService
    AdjustTokenPrivileges
    OpenProcessToken
    VerSetConditionMask
    GetCurrentProcessId
    CryptReleaseContext
    CryptGenRandom
    LZClose
    LZCopy

Imports:
    WaitForMultipleObjects
    WaitForSingleObject
    CreateEventW
    SetEvent
    GetDiskFreeSpaceW
    GetLogicalDriveStringsW
    PathAddBackslashW
    CloseServiceHandle
    StartServiceW
    ChangeServiceConfigW
    QueryServiceStatus
    CreateServiceW
    OpenServiceW
    OpenSCManagerW
    LookupPrivilegeValueW
    FindResourceW
    LoadResource
    LockResource
    SizeofResource
    RegDeleteKeyW
    RegQueryInfoKeyW
    RegEnumKeyExW
    RegOpenKeyW
    RegCloseKey
    RegSetValueExW
    VerifyVersionInfoW
    GetSystemDirectoryW
    memcpy
    memset
    HeapAlloc
    GetProcessHeap
    HeapReAlloc
    HeapFree
    PathFindExtensionW
    PathFileExistsW
    LZOpenFileW
    GetSystemTimeAsFileTime
    CreateFileW
    SetFilePointerEx
    ReadFile
    WriteFile
    FlushFileBuffers
    DeleteFileW
    FindFirstFileW
    FindNextFileW
    FindClose
    GetFileAttributesW
    GetFileInformationByHandle
    CreateThread
    GetCurrentProcess
    SetThreadPriority
    GetCommandLineW
    ExitProcess
    Sleep
    GetModuleHandleW
    GetProcAddress
    GetModuleFileNameW
    GetLastError
    SetLastError
    CryptAcquireContextW
    InitiateSystemShutdownExW
    StrStrW
    StrRChrW
    StrChrW
    StrToIntW
    PathAddExtensionW
    StrCatBuffW
    PathAppendW
    StrStrIW
    StrCmpNW
    wnsprintfW
    StrStrA
    towupper
    wcsncpy
    _except_handler3
    lstrcmpA
    CloseHandle
    lstrlenW
    wsprintfW
    CharLowerW
    CommandLineToArgvW

Notable Strings:
\\.\PhysicalDrive%u
\\.\EPMNTDRV\%u
\\.\
time fun
Program Files
Program Files(x86)
SYSTEM\CurrentControlSet\services\
Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced
SeLoadDriverPrivilege
SeBackupPrivilege
WaitForMultipleObjects
WaitForSingleObject
SetEvent
QueryServiceStatus
DeleteService
CloseServiceHandle
ControlService
OpenProcessToken
AdjustTokenPrivileges
LoadResource
LockResource
SizeofResource
RegCloseKey
VerSetConditionMask
HeapAlloc
GetProcessHeap
HeapReAlloc
HeapFree
GetSystemTimeAsFileTime
SetFilePointerEx
ReadFile
WriteFile
FlushFileBuffers
FindClose
GetFileInformationByHandle
CreateThread
GetCurrentProcess
SetThreadPriority
ExitProcess
GetCurrentProcessId
GetProcAddress
GetLastError
SetLastError
CryptGenRandom
CryptReleaseContext
towupper
DeviceIoControl
CloseHandle
_except_handler3
}%^}%K}%
%ws%.2ws
LZ32.dll
SHLWAPI.dll
msvcrt.dll
KERNEL32.dll
USER32.dll
ADVAPI32.dll
SHELL32.dll
tdrv.pdb
kernel32.dll
!This program cannot be run in DOS mode.
CreateEvent
Wow64DisableWow64FsRedirection
Wow64RevertWow64FsRedirection
GetDiskFreeSpace
GetLogicalDriveStrings
$Bitmap
$LogFile
$BITMAP
$I30
PathAddBackslash
OpenSCManager
OpenService
CreateService
ChangeServiceConfig
StartService
LookupPrivilegeValue
FindResource
RegDeleteKey
RegQueryInfoKey
RegEnumKeyEx
RegOpenKey
RegSetValueEx
VerifyVersionInfo
GetSystemDirectory
memcpy
memset
PathFileExists
PathFindExtension
LZOpenFile
CreateFile
DeleteFile
FindFirstFile
FindNextFile
GetFileAttributes
IsWow64Process
Sleep
GetCommandLine
GetModuleHandle
GetModuleFileName
CryptAcquireContext
LZClose
LZCopy
InitiateSystemShutdownEx
RichJJ
.text
`.rdata
@.data
.rsrc
@.reloc
NTFS    
GCTL
.text
.text$mn
.idata$5
.rdata
.rdata$zzzdbg
.xdata$x
.idata$2
.idata$3
.idata$4
.idata$6
.data
.bss
.rsrc$01
.rsrc$02
StrStr
wnsprintf
StrCmpN
StrStrI
PathAppend
StrCatBuff
PathAddExtension
StrToInt
StrChr
StrRChr
StrStr
wcsncpy
lstrcmp
lstrlen
wsprintf
CharLower
CommandLineToArgv
!Thi
s progra
m cannot
 be run 
in DOS m
ode.
.text
h.rdat
llocateP
oolWithT
etLowerD
eviceOb
Build
IoContro
lRequest
ymbolicL
RtlIn
itUnicod
eString
SetEven
MmMap
LockedPa
gesSpeci
fyCach
Poin
Async
hronousF
Comp
WaitFor
Irwp
Att`
Referen
ToI|
gCheckEx
ntoskr_nl.ex
AnsiChar
Z0X03!
eriSign,
 Inc.1
rust Net
work1;09
2Terms 
of use a
t https:
//www.
.com/r
pa (c)10
0 CA0
1204230|
409112
35959Z0
Sichwuan
ngdu100.
'CHENG
DU YIWO 
Tech 
opm!
Ltd.1>0<
5Digita
l IDU
icrosoftk S
dation v
!Thi
s progra
m cannot
 be run 
in DOS m
ode.
Richt
.te-x
.rdata
INIT
eloc
Invali
d parame
ssed
 to C ru
ntime fu
nction.8!
RSDS
wt|O
\epm2.0\
01_proje
ctarea\0
0_source
\mod.wi
ndiskacc
essdrive
objf
re_wlh_x
86\i3
gPrint
IoGetL
owerDevi
ceObp
RtlCom
eUnicode{St
Init
ObfDeref
mbolicLiUn
memse
FreeIr
KeSe
tEve
nlockPag
PoolWith
itForS
fCall}D
uildAsyn
chronous
FsdReque
MapL
Speci
fyCach_
IoCon
trolT%
ickCo3
) BugChec
skrnl.ex
AnsiC
harTo
S0r0
VeriSig
n, Inc.1w
 Trust N
etwork1;
c2Term
s of use
 at http
s://www.
/rpa (c)
DigiCert Inc1
www.digicert.com1+0)
"DigiCert EV Code Signing CA (SHA2)0
210413000000Z
220414235959Z0
Private Organization1
HE 4194691
Nicosia1
Hermetica Digital Ltd1
Hermetica Digital Ltd0
1http://crl3.digicert.com/EVCodeSigningSHA2-g1.crl07
1http://crl4.digicert.com/EVCodeSigningSHA2-g1.crl0J
C0A06
0)0'
http://www.digicert.com/CPS0
r0p0$
http://ocsp.digicert.com0H
<http://cacerts.digicert.com/DigiCertEVCodeSigningCA-SHA2.crt0
7%4(
DigiCert Inc1
www.digicert.com1+0)
"DigiCert High Assurance EV Root CA0
120418120000Z
270418120000Z0l1
DigiCert Inc1
www.digicert.com1+0)
"DigiCert EV Code Signing CA (SHA2)0
+.+1Xf
s0q0$
http://ocsp.digicert.com0I
=http://cacerts.digicert.com/DigiCertHighAssuranceEVRootCA.crt0
:http://crl3.digicert.com/DigiCertHighAssuranceEVRootCA.crl0@
:http://crl4.digicert.com/DigiCertHighAssuranceEVRootCA.crl0
.http://www.digicert.com/ssl-cps-repository.htm0
:fk{
DigiCert Inc1
www.digicert.com1+0)
"DigiCert EV Code Signing CA (SHA2)
\??\
\\?\
ntuser
AppData
My Documents
Desktop
\\?\C:\Documents and Settings
\\?\C:\Windows\System32\winevt\Logs
RCDATA
DRV_X64
DRV_X86
DRV_XP_X64
DRV_XP_X86
Drivers
System32
%s%s
Windows
PerfLogs
Boot
System Volume Information
%ws%ws
ServicesActive
C:\Windows\SYSVOL
C:\System Volume Information
ShowCompColor
ShowInfoTip
SYSTEM\CurrentControlSet\Control\CrashControl
CrashDumpEnabled
$ATTRIBUTE_LIST
$EA_INFORMATION
$SECURITY_DESCRIPTOR
$DATA
$INDEX_ROOT
$INDEX_ALLOCATION
$REPARSE_POINT
$LOGGED_UTILITY_STREAM
::$INDEX_ALLOCATION
\r\n
RCDATA
DRV_X64
DRV_X86\r\nRV_XP_X64\r\nRV_XP_X86
\r\n
\Dev
\r\n