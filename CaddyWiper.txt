Caddy Wiper Public Sample

Wiper malware that is able to detect domain controller to maintin persistance.

+------------------------+------------------------------------------------------------------------------------+
| md5                    | 42e2b6e4fba51ec71235e28ddff27a76                                                   |
| sha1                   | 4f3362ebac2503906179bd7c002f573886fa85a5                                           |
| sha256                 | 1e87e9b5ee7597bdce796490f3ee09211df48ba1d11f6e2f5b255f05cc0ba176                   |
| path                   | CaddyWiper                                                                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
| DISCOVERY              | System Network Configuration Discovery:: T1016                                     |
| EXECUTION              | Shared Modules:: T1129                                                             |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings (8 matches)          | anti-analysis/obfuscation/string/stackstring         |
| get domain information                               | host-interaction/network/domain                      |
| access PEB ldr_data                                  | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+

Libraries:
    netapi32.dll
    kernel32.dll
    advapi32.dll

Imports:
    DsRoleGetPrimaryDomainInformation
    LoadLibraryA
    DeviceIoControl
    CreateFileW
    CloseHandle
    LookupPrivilegeValueA
    AdjustTokenPrivileges
    GetLastError
    SetEntriesInAclA
    AllocateAndInitializeSid
    SetNamedSecurityInfoA
    GetCurrentProcess
    OpenProcessToken
    SetTakeOwnershipPrivilege
    FreeSid
    LocalFree
    CloseHandle
    FindFirstFileA
    FindNextFileA
    CreateFileA
    GetFileSize
    LocalAlloc
    SetFilePointer
    WriteFile
    LocalFree
    CloseHandle
    FindClose
    
Notable Strings:
    C:\\Users
    D:\\
    \\\\.\\PhysicalDrive
    Chttp://cacerts.digicert.com/DigiCertSHA2AssuredIDTimestampingCA.crt0
    Chttp://cacerts.digicert.com/DigiCertSHA2AssuredIDTimestampingCA.crt0
    7http://cacerts.digicert.com/DigiCertAssuredIDRootCA.crt0
    7http://cacerts.digicert.com/DigiCertAssuredIDRootCA.crt0
    4http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0P
    4http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0P
    4http://crl4.digicert.com/DigiCertAssuredIDRootCA.crl0:
    4http://crl4.digicert.com/DigiCertAssuredIDRootCA.crl0:
    ,http://crl3.digicert.com/sha2-assured-ts.crl02
    ,http://crl3.digicert.com/sha2-assured-ts.crl02
    ,http://crl4.digicert.com/sha2-assured-ts.crl0
    ,http://crl4.digicert.com/sha2-assured-ts.crl0
    (DigiCert SHA2 Assured ID Timestamping CA0
    (DigiCert SHA2 Assured ID Timestamping CA0
    (DigiCert SHA2 Assured ID Timestamping CA0
    (DigiCert SHA2 Assured ID Timestamping CA0
    !This program cannot be run in DOS mode.
    (DigiCert SHA2 Assured ID Timestamping C
    (DigiCert SHA2 Assured ID Timestamping C
    !http://crl.trustasia.com/code.crl0=
    !http://crl.trustasia.com/code.crl0=
    !http://aia.trustasia.com/code.cer0
    !http://aia.trustasia.com/code.cer0
    DsRoleGetPrimaryDomainInformation
    http://crl.trustasia.com/ca.crl0;
    http://crl.trustasia.com/ca.crl0;
    TrustAsia Technologies, Inc.1'0%
    TrustAsia Technologies, Inc.1'0%
    TrustAsia Technologies, Inc.1'0%
    TrustAsia Technologies, Inc.1'0%
    TrustAsia Technologies, Inc.1'0%
    TrustAsia Technologies, Inc.1'0%
    http://aia.trustasia.com/ca.cer0
    http://aia.trustasia.com/ca.cer0
    TrustAsia SHA2 Code Signing CA0
    TrustAsia SHA2 Code Signing CA0
    TrustAsia SHA2 Code Signing CA0
    TrustAsia SHA2 Code Signing CA0
    TrustAsia SHA2 Code Signing C
    TrustAsia SHA2 Code Signing C
    TrustAsia Technologies, Inc.1
    TrustAsia Technologies, Inc.1
    TrustAsia Technologies, Inc.1
    TrustAsia Technologies, Inc.1
    https://www.digicert.com/CPS0
    https://www.digicert.com/CPS0
    DigiCert Assured ID Root CA0
    DigiCert Assured ID Root CA0
    http://www.digicert.com/CPS0
    http://www.digicert.com/CPS0
    http://ocsp.digicert.com0C
    http://ocsp.digicert.com0C
    http://ocsp.digicert.com0O
    http://ocsp.digicert.com0O
    DigiCert Timestamp 20210
    DigiCert Timestamp 20210
    www.digicert.com1$0"
    www.digicert.com1$0"
    www.digicert.com110/
    www.digicert.com110/
    www.digicert.com110/
    www.digicert.com110/
    www.digicert.com110/
    www.digicert.com110/
    TrustAsia Root CA0
    TrustAsia Root CA0
    DigiCert, Inc.1 0
    DigiCert, Inc.1 0
    251230074800Z0]1
    251230074800Z0]1
    310106000000Z0H1
    310106000000Z0H1
    310107120000Z0r1
    310107120000Z0r1
    TrustAsia Root C
    TrustAsia Root C
    20220316010154Z
    220316010154Z0+
    220316010154Z0/
    200129054300Z0
    200129054300Z0
    150101074800Z
    150101074800Z
    160107120000Z
    160107120000Z
    180129054300Z
    180129054300Z
    210101000000Z
    210101000000Z
    DigiCert Inc1
    DigiCert Inc1
    DigiCert Inc1
    DigiCert Inc1
    DigiCert Inc1
    DigiCert Inc1
    DigiCert Inc1
    DigiCert Inc1
    NETAPI32.dll
    /1(0&0$0"
    -xdU%K[k
    @.reloc
    A"aLk="
    QJxy6z'
    QJxy6z'
    `.rdata
    dwc_#Ri
    dwc_#Ri
    o\`E;
    8aMbF$
    8aMbF$
    CN1%0#
    CN1%0#
    CN1%0#
    CN1%0#
    CN1%0#
    CN1%0#
    CN1%0#
    CN1%0#
    CN1%0#
    CN1%0#


