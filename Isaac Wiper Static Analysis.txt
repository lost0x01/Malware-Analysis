Isaac Wiper Static Analysis

Sample name: 13037b749aa4b1eda538fda26d6ac41c8f7b1d02d83f47b0d187dd645154e033
File ReName: isaacwiper
File Type: dll
md5: ecce8845921a91854ab34bff2623151e                                                   |
sha1: 736a4cfad1ed83a6a0b75b0474d5e01a3a36f950                                           |
sha256: 13037b749aa4b1eda538fda26d6ac41c8f7b1d02d83f47b0d187dd645154e033 

Summary: Data wiper software that can delete all files and change MBR to make machine effectively inoperable.  Has a fast fail sequence to abort running on virtual machine or in a debugger.  Also has geo-location trackingand failsafe.

| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | File and Directory Permissions Modification [T1222]                                |
|                        | Obfuscated Files or Information [T1027]                                            |
| DISCOVERY              | File and Directory Discovery [T1083]                                               |
|                        | System Information Discovery [T1082]                                               |
|                        | System Location Discovery [T1614]                                                  |
| EXECUTION              | Command and Scripting Interpreter [T1059]                                          |
|                        | Shared Modules [T1129]                                                             |
|                        | System Services::Service Execution [T1569.002]                                     |
| IMPACT                 | System Shutdown/Reboot [T1529]                                                     |

CAPABILITY                                                     | NAMESPACE                                            |
|--------------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                        | anti-analysis/anti-debugging/debugger-detection      |
| get geographical location (7 matches)                        | collection                                           |
| encode data using XOR (6 matches)                            | data-manipulation/encoding/xor                       |
| generate random numbers using a Mersenne Twister (5 matches) | data-manipulation/prng/mersenne                      |
| accept command line arguments                                | host-interaction/cli                                 |
| interact with driver via control codes (4 matches)           | host-interaction/driver                              |
| query environment variable                                   | host-interaction/environment-variable                |
| get common file path (4 matches)                             | host-interaction/file-system                         |
| create directory                                             | host-interaction/file-system/create                  |
| check if file exists                                         | host-interaction/file-system/exists                  |
| enumerate files recursively                                  | host-interaction/file-system/files/list              |
| get file size (2 matches)                                    | host-interaction/file-system/meta                    |
| set file attributes                                          | host-interaction/file-system/meta                    |
| move file                                                    | host-interaction/file-system/move                    |
| read file (4 matches)                                        | host-interaction/file-system/read                    |
| write file (8 matches)                                       | host-interaction/file-system/write                   |
| get disk information                                         | host-interaction/hardware/storage                    |
| get disk size                                                | host-interaction/hardware/storage                    |
| shutdown system                                              | host-interaction/os                                  |
| allocate thread local storage (2 matches)                    | host-interaction/process                             |
| get thread local storage value (2 matches)                   | host-interaction/process                             |
| set thread local storage value (2 matches)                   | host-interaction/process                             |
| terminate process (3 matches)                                | host-interaction/process/terminate                   |
| terminate process via fastfail (7 matches)                   | host-interaction/process/terminate                   |
| create thread (4 matches)                                    | host-interaction/thread/create                       |
| terminate thread (2 matches)                                 | host-interaction/thread/terminate                    |
| link function at runtime (2 matches)                         | linking/runtime-linking                              |
| link many functions at runtime                               | linking/runtime-linking                              |
| parse PE exports                                             | load-code/pe                                         |
| parse PE header (5 matches)                                  | load-code/pe 

Libraries:
    kernel32.dll
    user32.dll

Imports:
    WaitForMultipleObjects
    WaitForSingleObject
    EnterCriticalSection
    LeaveCriticalSection
    DeleteCriticalSection
    InitializeCriticalSectionAndSpinCount
    InitializeSListHead
    InterlockedFlushSList
    GetDiskFreeSpaceExW
    GetLogicalDrives
    GetWindowsDirectoryW
    GetTickCount
    QueryPerformanceCounter
    IsDebuggerPresent
    GetStartupInfoW
    IsProcessorFeaturePresent
    EnumSystemLocalesW
    HeapSize
    GetStringTypeW
    HeapAlloc
    HeapFree
    HeapReAlloc
    GetProcessHeap
    CreateFileW
    CreateDirectoryW
    FindFirstFileW
    GetFileSizeEx
    FindNextFileW
    WriteFile
    FindClose
    SetFileAttributesW
    GetTempFileNameW
    MoveFileW
    SetEndOfFile
    GetSystemTimeAsFileTime
    FlushFileBuffers
    SetFilePointerEx
    GetFileType
    ReadFile
    FindFirstFileExW
    GetExitCodeThread
    TerminateThread
    CreateThread
    TlsAlloc
    TlsGetValue
    TlsSetValue
    TlsFree
    GetCurrentProcessId
    GetCurrentThreadId
    GetCurrentProcess
    TerminateProcess
    ExitProcess
    GetCommandLineA
    GetCommandLineW
    GetEnvironmentStringsW
    FreeEnvironmentStringsW
    UnhandledExceptionFilter
    SetUnhandledExceptionFilter
    RaiseException
    GetModuleHandleW
    GetProcAddress
    FreeLibrary
    LoadLibraryExW
    GetModuleHandleExW
    GetModuleFileNameW
    GetLastError
    SetLastError
    WriteConsoleW
    GetConsoleCP
    GetConsoleMode
    GetStdHandle
    SetStdHandle
    ReadConsoleW
    ExitWindowsEx
    DeviceIoControl
    CloseHandle
    MultiByteToWideChar
    WideCharToMultiByte
    EncodePointer
    DecodePointer
    LCMapStringW
    GetLocaleInfoW
    GetCPInfo
    RtlUnwind
    IsValidLocale
    GetUserDefaultLCID
    IsValidCodePage
    GetACP
    GetOEMCP

Notable strings:
    .?AU_Crt_new_delete@std@@
    .?AUctype_base@std@@
    .?AV?$_Iosb@H@std@@
    .?AV?$basic_filebuf@_WU?$char_traits@_W@std@@@std@@
    .?AV?$basic_fstream@_WU?$char_traits@_W@std@@@std@@
    .?AV?$basic_ios@_WU?$char_traits@_W@std@@@std@@
    .?AV?$basic_iostream@_WU?$char_traits@_W@std@@@std@@
    .?AV?$basic_istream@_WU?$char_traits@_W@std@@@std@@
    .?AV?$basic_ostream@_WU?$char_traits@_W@std@@@std@@
    .?AV?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@
    .?AV?$codecvt@_WDU_Mbstatet@@@std@@
    .?AV?$ctype@_W@std@@
    .?AV?$num_put@_WV?$ostreambuf_iterator@_WU?$char_traits@_W@std@@@std@@@std@@
    .?AV?$numpunct@_W@std@@
    .?AV_Facet_base@std@@
    .?AV_Iostream_error_category2@std@@
    .?AV_Locimp@locale@std@@
    .?AV_System_error@std@@
    .?AVbad_alloc@std@@
    .?AVbad_array_new_length@std@@
    .?AVbad_exception@std@@
    .?AVcodecvt_base@std@@
    .?AVerror_category@std@@
    .?AVexception@std@@
    .?AVfacet@locale@std@@
    .?AVfailure@ios_base@std@@
    .?AVios_base@std@@
    .?AVlength_error@std@@
    .?AVlogic_error@std@@
    .?AVout_of_range@std@@
    .?AVruntime_error@std@@
    .?AVsystem_error@std@@
    .?AVtype_info@@
    Cleaner.dll
    CreateDirectory
    CreateEventEx
    CreateFile
    CreateSemaphore
    CreateSemaphoreEx
    CreateThread
    DeleteCriticalSection
    EncodePointer
    EnterCriticalSection
    EnumSystemLocales
    EnumSystemLocalesEx
    ExitProcess
    FindClose
    FlushFileBuffers
    FlushProcessWriteBuffers
    FreeEnvironmentStrings
    FreeLibrary
    FreeLibraryWhenCallbackReturns
    GetACP
    GetCPInfo
    GetCommandLine
    GetCommandLine
    GetConsoleCP
    GetConsoleMode
    GetCurrentPackageId
    GetCurrentProcess
    GetDateFormatEx
    GetDiskFreeSpaceEx
    GetExitCodeThread
    GetFileSizeEx
    GetFileType
    GetLastError
    GetLocaleInfo
    GetLocaleInfoEx
    GetLogicalDrives
    GetModuleFileName
    GetModuleHandle
    GetOEMCP
    GetProcAddress
    GetProcessHeap
    GetStartupInfo
    GetStdHandle
    GetStringType
    GetSystemTimeAsFileTime
    GetSystemTimePreciseAsFileTime
    GetTickCount
    GetTickCount64
    GetTimeFormatEx
    GetUserDefaultLCID
    GetUserDefaultLocaleName
    GetWindowsDirectory
    InitOnceExecuteOnce
    InitializeConditionVariable
    InitializeCriticalSectionAndSpinCount
    InitializeCriticalSectionEx
    InitializeSListHead
    InitializeSRWLock
    InterlockedFlushSList
    IsDebuggerPresent
    IsProcessorFeaturePresent
    IsValidCodePage
    IsValidLocale
    IsValidLocaleName
    KERNEL32.dll
    LCIDToLocaleName
    LCMapString
    LCMapStringEx
    LeaveCriticalSection
    LoadLibraryEx
    LocaleNameToLCID
    MultiByteToWideChar
    PhysicalDrive
    QueryPerformanceCounter
    ReadFile
    ReleaseSRWLockExclusive
    RtlUnwind
    SetEndOfFile
    SetFileInformationByHandle
    SetFilePointerEx
    SetLastError
    SetStdHandle
    SetThreadpoolTimer
    SetThreadpoolWait
    SetUnhandledExceptionFilter
    SleepConditionVariableCS
    SleepConditionVariableSR
    SubmitThreadpoolWork
    TlsAlloc
    TlsFree
    TlsGetValue
    TlsSetValue
    TryAcquireSRWLockExclusive
    USER32.dll
    UTF-16LEUNICODE
    UTF-8
    UnhandledExceptionFilter
    Unknown exception
    WaitForMultipleObjects
    WaitForSingleObject
    WakeAllConditionVariable
    WakeConditionVariable
    WideCharToMultiByte
    WriteConsole
    WriteFile
    __based(
    __cdecl
    __clrcall
    __eabi
    __fastcall
    __pascal
    __ptr64
    __restrict
    __stdcall
    __swift_1
    __swift_2
    __thiscall
    __unaligned
    __vectorcall
    _cabs
    _hypot
    _logb
    _nextafter
    `SVW
    `anonymous namespace'
    `copy constructor closure'
    `default constructor closure'
    `dynamic atexit destructor for '
    `dynamic initializer for '
    `eh vector constructor iterator'
    `eh vector copy constructor iterator'
    `eh vector destructor iterator'
    `eh vector vbase constructor iterator'
    `eh vector vbase copy constructor iterator'
    `local static guard'
    `local static thread guard'
    `local vftable constructor closure'
    `local vftable'
    `managed vector constructor iterator'
    `managed vector copy constructor iterator'
    `managed vector destructor iterator'
    `omni callsig'
    `placement delete closure'
    `placement delete[] closure'
    `scalar deleting destructor'
    `udt returning'
    `vbase destructor'
    `vbtable'
    `vcall'
    `vector constructor iterator'
    `vector copy constructor iterator'
    `vector deleting destructor'
    `vector destructor iterator'
    `vector vbase constructor iterator'
    `vector vbase copy constructor iterator'
    `vftable'
    `virtual displacement map'
    address family not supported
    address in use
    address not available
    advapi32
    already connected
    api-ms-win-appmodel-runtime-l1-1-2
    api-ms-win-core-datetime-l1-1-1
    api-ms-win-core-fibers-l1-1-1
    api-ms-win-core-file-l1-2-2
    api-ms-win-core-localization-l1-2-1
    api-ms-win-core-localization-obsolete-l1-2-0
    api-ms-win-core-processthreads-l1-1-2
    api-ms-win-core-string-l1-1-0
    api-ms-win-core-synch-l1-2-0
    api-ms-win-core-sysinfo-l1-2-1
    api-ms-win-core-winrt-l1-1-0
    api-ms-win-core-xstate-l2-1-0
    api-ms-win-rtcore-ntuser-window-l1-1-0
    api-ms-win-security-systemfunctions-l1-1-0
    argument list too long
    argument out of domain
    bad address
    bad allocation
    bad array new length
    bad exception
    bad file descriptor
    bad locale name
    bad message
    connection aborted
    connection already in progress
    connection refused
    connection reset
    cross device link
    destination address required
    device or resource busy
    directory not empty
    executable format error
    ext-ms-win-ntuser-dialogbox-l1-1-0
    ext-ms-win-ntuser-windowstation-l1-1-0
    file exists
    file too large
    filename too long
    function not supported
    getting drives...
    identifier removed
    illegal byte sequence
    inappropriate io control operation
    interrupted
    invalid argument
    invalid seek
    invalid string position
    io error
    ios_base::badbit set
    ios_base::eofbit set
    ios_base::failbit set
    iostream
    iostream stream error
    kernel32
    kernel32.dll
    logical drives:
    message size
    mscoree.dll
    no buffer space
    no child process
    no link
    no lock available
    no message
    no message available
    no protocol option
    no space on device
    no stream resources
    no such device
    no such device or address
    no such file or directory
    no such process
    not a directory
    not a socket
    not a stream
    not connected
    not enough memory
    not supported
    operation canceled
    operation in progress
    operation not permitted
    operation not supported
    operation would block
    operator
    operator "" 
    operator co_await
    operator<=>
    owner dead
    permission denied
    physical drive 
    physical drives:
    protocol error
    protocol not supported
    read only file system
    resource deadlock would occur
    resource unavailable try again
    restrict(
    result out of range
    start erasing physical drives...
    start erasing system logical drive 
    start erasing system physical drive...
    state not recoverable
    stream timeout
    string too long
    system physical drive -- FAILED
    too many files open
    too many files open in system
    too many links
    too many symbolic link levels
    wrong protocol type
