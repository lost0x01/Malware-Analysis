Sample Name:0385eeab00e946a302b24a91dea4187c1210597b8e17cd9e2230450f5ece21da
File ReName: hermeticwiper.exe
File Type: PE32 Executable
md5: 84ba0197920fd3e2b7dfa719fee09d2f
sha1: 912342f1c840a42f6b74132f8a7c4ffe7d40fb77
sha256: 0385eeab00e946a302b24a91dea4187c1210597b8e17cd9e2230450f5ece21da

| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry [T1112]                                                            |
| DISCOVERY              | File and Directory Discovery [T1083]                                               |
|                        | Query Registry [T1012]                                                             |
|                        | System Information Discovery [T1082]                                               |
|                        | System Service Discovery [T1007]                                                   |
| EXECUTION              | Command and Scripting Interpreter [T1059]                                          |
|                        | Shared Modules [T1129]                                                             |
|                        | System Services::Service Execution [T1569.002]                                     |
| IMPACT                 | Service Stop [T1489]                                                               |
| PERSISTENCE            | Create or Modify System Process::Windows Service [T1543.003]                       |
| PRIVILEGE ESCALATION   | Access Token Manipulation [T1134]                                                  |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| FILE SYSTEM                 | Delete File [C0047]                                                           |
|                             | Read File [C0051]                                                             |
|                             | Writes File [C0052]                                                           |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread [C0038]                                                         |
|                             | Terminate Process [C0018]                                                     |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| interact with driver via control codes (9 matches)   | host-interaction/driver                              |
| get common file path                                 | host-interaction/file-system                         |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| read file (3 matches)                                | host-interaction/file-system/read                    |
| write file (2 matches)                               | host-interaction/file-system/write                   |
| get disk information                                 | host-interaction/hardware/storage                    |
| get disk size (2 matches)                            | host-interaction/hardware/storage                    |
| check OS version                                     | host-interaction/os/version                          |
| modify access privileges (2 matches)                 | host-interaction/process/modify                      |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| delete registry key                                  | host-interaction/registry/delete                     |
| query service status                                 | host-interaction/service                             |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| modify service (2 matches)                           | host-interaction/service/modify                      |
| start service                                        | host-interaction/service/start                       |
| stop service                                         | host-interaction/service/stop                        |
| create thread (4 matches)                            | host-interaction/thread/create                       |
| link function at runtime                             | linking/runtime-linking                              |
| parse PE header (3 matches)                          | load-code/pe  

Registry Access: 
  SYSTEM\CurrentControlSet\services\
  Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced

Registry Values Added:
  HKU\S-1-5-21-1866265027-1870850910-1579135973-1000\Software\Classes\Local Settings\MuiCache\44\52C64B7E\@%SystemRoot%\System32\acppage.dll,-6006: "Program Compatibility"
  HKU\S-1-5-21-1866265027-1870850910-1579135973-1000\Software\Classes\Local Settings\MuiCache\44\52C64B7E\@%systemroot%\system32\rshx32.DLL,-59: "Permissions editor for files and folders"
  HKU\S-1-5-21-1866265027-1870850910-1579135973-1000\Software\Classes\Local Settings\MuiCache\44\52C64B7E\@%SystemRoot%\System32\urlmon.dll,-4200: "Open File - Security Warning"
  HKU\S-1-5-21-1866265027-1870850910-1579135973-1000_Classes\Local Settings\MuiCache\44\52C64B7E\@%SystemRoot%\System32\acppage.dll,-6006: "Program Compatibility"
  HKU\S-1-5-21-1866265027-1870850910-1579135973-1000_Classes\Local Settings\MuiCache\44\52C64B7E\@%systemroot%\system32\rshx32.DLL,-59: "Permissions editor for files and folders"
  HKU\S-1-5-21-1866265027-1870850910-1579135973-1000_Classes\Local Settings\MuiCache\44\52C64B7E\@%SystemRoot%\System32\urlmon.dll,-4200: "Open File - Security Warning"


Libraries:
  shlwapi.dll
  lz32.dll
  msvcrt.dll
  kernel32.dll
  user32.dll
  advapi32.dll
  shell32.dll

Blacklist Import Names:
  ControlService
  DeleteService
  AdjustTokenPrivileges
  OpenProcessToken
  VerSetConditionMask
  GetCurrentProcessId
  CryptReleaseContext
  CryptGenRandom
  LZClose
  LZCopy
  DeviceIoControl

Import Names:
  WaitForMultipleObjects
  WaitForSingleObject
  CreateEventW
  SetEvent
  GetDiskFreeSpaceW
  GetLogicalDriveStringsW
  PathAddBackslashW
  CloseServiceHandle
  StartServiceW
  ChangeServiceConfigW
  QueryServiceStatus
  CreateServiceW
  OpenServiceW
  OpenSCManagerW
  LookupPrivilegeValueW
  FindResourceW
  LoadResource
  LockResource
  SizeofResource
  RegDeleteKeyW
  RegQueryInfoKeyW
  RegEnumKeyExW
  RegOpenKeyW
  RegCloseKey
  RegSetValueExW
  VerifyVersionInfoW
  GetSystemDirectoryW
  memcpy
  memset
  HeapAlloc
  GetProcessHeap
  HeapReAlloc
  HeapFree
  PathFindExtensionW
  PathFileExistsW
  LZOpenFileW
  GetSystemTimeAsFileTime
  CreateFileW
  SetFilePointerEx
  ReadFile
  WriteFile
  FlushFileBuffers
  FindFirstFileW
  FindNextFileW
  FindClose
  GetFileInformationByHandle
  DeleteFileW
  CreateThread
  GetCurrentProcess
  Sleep
  SetThreadPriority
  GetCommandLineW
  ExitProcess
  GetModuleHandleW
  GetProcAddress
  GetModuleFileNameW
  GetLastError
  SetLastError
  CryptAcquireContextW
  InitiateSystemShutdownExW
  StrStrW
  StrRChrW
  StrChrW
  StrToIntW
  PathAddExtensionW
  StrCatBuffW
  PathAppendW
  StrStrIW
  StrCmpNW
  wnsprintfW
  StrStrA
  towupper
  wcsncpy
  _except_handler3
  lstrcmpA
  CloseHandle
  lstrlenW
  wsprintfW
  CharLowerW
  CommandLineToArgvW

Strings:
  DigiCert Inc1
  www.digicert.com1+0)
  "DigiCert EV Code Signing CA (SHA2)0
  210413000000Z
  220414235959Z0
  Private Organization1
  HE 4194691
  Nicosia1
  Hermetica Digital Ltd1
  Hermetica Digital Ltd0
  CY-HE 4194690
  1http://crl3.digicert.com/EVCodeSigningSHA2-g1.crl07
  1http://crl4.digicert.com/EVCodeSigningSHA2-g1.crl0J
  http://www.digicert.com/CPS0
  http://ocsp.digicert.com0H
  <http://cacerts.digicert.com/DigiCertEVCodeSigningCA-SHA2.crt0
  DigiCert Inc1
  www.digicert.com1+0)
  "DigiCert High Assurance EV Root CA0
  120418120000Z
  270418120000Z0l1
  DigiCert Inc1
  www.digicert.com1+0)
  "DigiCert EV Code Signing CA (SHA2)0
  http://ocsp.digicert.com0I
  =http://cacerts.digicert.com/DigiCertHighAssuranceEVRootCA.crt0
  :http://crl3.digicert.com/DigiCertHighAssuranceEVRootCA.crl0@
  :http://crl4.digicert.com/DigiCertHighAssuranceEVRootCA.crl0
  .http://www.digicert.com/ssl-cps-repository.htm0
  DigiCert Inc1
  www.digicert.com1+0)
  "DigiCert EV Code Signing CA (SHA2)
  Wow64DisableWow64FsRedirection
  Wow64RevertWow64FsRedirection
